import inquirer from 'inquirer';
import getEmojis from "../../utils/getEmojis.js";
import COMMIT_MODES from "../../constants/commit.js";
import withHook, { registerHookInterruptionHandler, cancelIfNeeded } from "./withHook/index.js";
import withClient from "./withClient/index.js";
import prompts from "./prompts.js";
const promptAndCommit = options => getEmojis().then(gitmojis => prompts(gitmojis, options)).then(questions => {
  inquirer.prompt(questions).then(answers => {
    if (options.mode === COMMIT_MODES.HOOK) return withHook(answers);
    return withClient(answers);
  });
});
const commit = options => {
  if (options.mode === COMMIT_MODES.HOOK) {
    registerHookInterruptionHandler();
    return cancelIfNeeded().then(() => promptAndCommit(options));
  }
  return promptAndCommit(options);
};
export default commit;